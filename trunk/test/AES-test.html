<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<head>

<!-- YUI CSS -->
<link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/2.7.0/build/logger/assets/logger.css">
<link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/2.7.0/build/yuitest/assets/testlogger.css">

<!-- Customizations -->
<link rel="stylesheet" type="text/css" href="lib/tester.css">

<!-- YUI JS -->
<script type="text/javascript" src="http://yui.yahooapis.com/2.7.0/build/yahoo-dom-event/yahoo-dom-event.js"></script>
<script type="text/javascript" src="http://yui.yahooapis.com/2.7.0/build/logger/logger-min.js"></script>
<script type="text/javascript" src="http://yui.yahooapis.com/2.7.0/build/yuitest/yuitest-min.js"></script>

<!-- Test subject -->
<script type="text/javascript" src="../src/Crypto.js"></script>
<script type="text/javascript" src="../src/AES.js"></script>
<script type="text/javascript" src="../src/ECB.js"></script>

<!-- Test cases -->
<script type="text/javascript">

// Shortcut
var Assert = YAHOO.util.Assert;

YAHOO.tool.TestRunner.add(
new YAHOO.tool.TestCase({

	test_AES128: function () {

		// Test vectors
		Crypto.AES._Init([0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F]);
		Assert.areEqual("69c4e0d86a7b0430d8cdb78070b4c55a", Crypto.util.bytes_hex(Crypto.AES._EncryptBlock([0x00, 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77, 0x88, 0x99, 0xAA, 0xBB, 0xCC, 0xDD, 0xEE, 0xFF])));

		// Test D(E(m)) == m
		var key = [Math.floor(Math.random() * 0x100000000), Math.floor(Math.random() * 0x100000000),
		           Math.floor(Math.random() * 0x100000000), Math.floor(Math.random() * 0x100000000)],
		    keyBytes  = Crypto.util.words_bytes(key),
		    keyString = Crypto.util.bytes_string(keyBytes);
		Assert.areEqual([0x00, 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77, 0x88, 0x99, 0xAA, 0xBB, 0xCC, 0xDD, 0xEE, 0xFF].toString(), Crypto.AES._DecryptBlock(Crypto.AES._EncryptBlock([0x00, 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77, 0x88, 0x99, 0xAA, 0xBB, 0xCC, 0xDD, 0xEE, 0xFF], keyBytes), keyBytes).toString());
		Assert.areEqual("\x00\x11\x22\x33\x44\x55\x66\x77\x88\x99\xAA\xBB\xCC\xDD\xEE\xFF", Crypto.AES.decrypt(Crypto.AES.encrypt("\x00\x11\x22\x33\x44\x55\x66\x77\x88\x99\xAA\xBB\xCC\xDD\xEE\xFF", keyString, Crypto.mode.ECB), keyString, Crypto.mode.ECB));

	},

	test_AES192: function () {

		// Test vectors
		Crypto.AES._Init([0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F, 0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17]);
		Assert.areEqual("dda97ca4864cdfe06eaf70a0ec0d7191", Crypto.util.bytes_hex(Crypto.AES._EncryptBlock([0x00, 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77, 0x88, 0x99, 0xAA, 0xBB, 0xCC, 0xDD, 0xEE, 0xFF])));

		// Test D(E(m)) == m
		var key = [Math.floor(Math.random() * 0x100000000), Math.floor(Math.random() * 0x100000000),
		           Math.floor(Math.random() * 0x100000000), Math.floor(Math.random() * 0x100000000),
		           Math.floor(Math.random() * 0x100000000), Math.floor(Math.random() * 0x100000000)],
		    keyBytes  = Crypto.util.words_bytes(key),
		    keyString = Crypto.util.bytes_string(keyBytes);
		Assert.areEqual([0x00, 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77, 0x88, 0x99, 0xAA, 0xBB, 0xCC, 0xDD, 0xEE, 0xFF].toString(), Crypto.AES._DecryptBlock(Crypto.AES._EncryptBlock([0x00, 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77, 0x88, 0x99, 0xAA, 0xBB, 0xCC, 0xDD, 0xEE, 0xFF], keyBytes), keyBytes).toString());
		Assert.areEqual("\x00\x11\x22\x33\x44\x55\x66\x77\x88\x99\xAA\xBB\xCC\xDD\xEE\xFF", Crypto.AES.decrypt(Crypto.AES.encrypt("\x00\x11\x22\x33\x44\x55\x66\x77\x88\x99\xAA\xBB\xCC\xDD\xEE\xFF", keyString, Crypto.mode.ECB), keyString, Crypto.mode.ECB));

	},

	test_AES256: function () {

		// Test vectors
		Crypto.AES._Init([0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F, 0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17, 0x18, 0x19, 0x1A, 0x1B, 0x1C, 0x1D, 0x1E, 0x1F]);
		Assert.areEqual("8ea2b7ca516745bfeafc49904b496089", Crypto.util.bytes_hex(Crypto.AES._EncryptBlock([0x00, 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77, 0x88, 0x99, 0xAA, 0xBB, 0xCC, 0xDD, 0xEE, 0xFF])));

		// Test D(E(m)) == m
		var key = [Math.floor(Math.random() * 0x100000000), Math.floor(Math.random() * 0x100000000),
		           Math.floor(Math.random() * 0x100000000), Math.floor(Math.random() * 0x100000000),
		           Math.floor(Math.random() * 0x100000000), Math.floor(Math.random() * 0x100000000),
		           Math.floor(Math.random() * 0x100000000), Math.floor(Math.random() * 0x100000000)],
		    keyBytes  = Crypto.util.words_bytes(key),
		    keyString = Crypto.util.bytes_string(keyBytes);
		Assert.areEqual([0x00, 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77, 0x88, 0x99, 0xAA, 0xBB, 0xCC, 0xDD, 0xEE, 0xFF].toString(), Crypto.AES._DecryptBlock(Crypto.AES._EncryptBlock([0x00, 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77, 0x88, 0x99, 0xAA, 0xBB, 0xCC, 0xDD, 0xEE, 0xFF], keyBytes), keyBytes).toString());
		Assert.areEqual("\x00\x11\x22\x33\x44\x55\x66\x77\x88\x99\xAA\xBB\xCC\xDD\xEE\xFF", Crypto.AES.decrypt(Crypto.AES.encrypt("\x00\x11\x22\x33\x44\x55\x66\x77\x88\x99\xAA\xBB\xCC\xDD\xEE\xFF", keyString, Crypto.mode.ECB), keyString, Crypto.mode.ECB));

	}

})
);

YAHOO.util.Event.onDOMReady(function(){

	// Display results from the TestRunner
	var logger = new YAHOO.tool.TestLogger();

	// Hide info category
	logger.hideCategory("info");

	// Run all tests
	YAHOO.tool.TestRunner.run();

});

</script>

</head>
<body>
</body>
