<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<head>

<!-- YUI CSS -->
<link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/2.7.0/build/logger/assets/logger.css">
<link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/2.7.0/build/yuitest/assets/testlogger.css">

<!-- Customizations -->
<style type="text/css">
	.yui-log { font-size: 13px }
	.yui-log-container { right: auto; left: 1em }
	.yui-log .yui-log-bd { height: 40em }
</style>

<!-- YUI JS -->
<script type="text/javascript" src="http://yui.yahooapis.com/2.7.0/build/yahoo-dom-event/yahoo-dom-event.js"></script>
<script type="text/javascript" src="http://yui.yahooapis.com/2.7.0/build/logger/logger-min.js"></script>
<script type="text/javascript" src="http://yui.yahooapis.com/2.7.0/build/yuitest/yuitest-min.js"></script>

<!-- Test subject -->
<script type="text/javascript" src="../src/Crypto.js"></script>

<!-- Test cases -->
<script type="text/javascript">

// Shortcut
var Assert = YAHOO.util.Assert;

YAHOO.tool.TestRunner.add(
new YAHOO.tool.TestCase({

	test_u32: function(){
		Assert.areEqual(Crypto.util.u32(2147483647), 2147483647);
		Assert.areEqual(Crypto.util.u32(2147483646), 2147483646);
		Assert.areEqual(Crypto.util.u32(2), 2);
		Assert.areEqual(Crypto.util.u32(1), 1);
		Assert.areEqual(Crypto.util.u32(0), 0);
		Assert.areEqual(Crypto.util.u32(-1), 4294967295);
		Assert.areEqual(Crypto.util.u32(-2), 4294967294);
		Assert.areEqual(Crypto.util.u32(-2147483647), 2147483649);
		Assert.areEqual(Crypto.util.u32(-2147483648), 2147483648);
	},

	test_add: function(){
		Assert.areEqual(Crypto.util.add(4294967295, 1), 0);
		Assert.areEqual(Crypto.util.add(2147483647, 1), 2147483648);
		Assert.areEqual(Crypto.util.add(4294967295, 2147483647, 1), 2147483647);
	},

	test_mult: function(){
		Assert.areEqual(Crypto.util.mult(4294967295, 4294967295), 1);
		Assert.areEqual(Crypto.util.mult(2147483648, 2147483648), 0);
		Assert.areEqual(Crypto.util.mult(2863311530, 2863311530), 3817748708);
	},

	test_gt: function(){
		Assert.isTrue(Crypto.util.gt(-1, 1));
	},

	test_lt: function(){
		Assert.isTrue(Crypto.util.lt(1, -1));
	},

	test_rotl: function(){
		Assert.areEqual(Crypto.util.rotl(2852192000, 8), 16711850);
	},

	test_rotr: function(){
		Assert.areEqual(Crypto.util.rotr(2852192000, 8), 11141375);
	},

	test_endian: function(){
		Assert.areEqual(Crypto.util.endian(2160124144), 4041261184|0);
		Assert.areEqual(Crypto.util.endian(Crypto.util.endian(2160124144)), 2160124144|0);
	},

	test_string_bytes: function(){
		Assert.areEqual(Crypto.util.string_bytes("Hello, World!").toString(),
		                [0x48, 0x65, 0x6C, 0x6C, 0x6F, 0x2C, 0x20, 0x57, 0x6F, 0x72, 0x6C, 0x64, 0x21].toString());
	},

	test_bytes_string: function(){
		Assert.areEqual(Crypto.util.bytes_string([0x48, 0x65, 0x6C, 0x6C, 0x6F, 0x2C, 0x20, 0x57, 0x6F, 0x72, 0x6C, 0x64, 0x21]),
		                "Hello, World!");
	}

})
);

YAHOO.util.Event.onDOMReady(function(){

	// Display results from the TestRunner
	var logger = new YAHOO.tool.TestLogger();

	// Hide info category
	logger.hideCategory("info");

	// Run all tests
	YAHOO.tool.TestRunner.run();

});

</script>

</head>
<body>
</body>
